
@using GRC_Copie.Controllers;
@using Microsoft.AspNetCore.Http;
@inject IHttpContextAccessor HttpContextAccessor;
@{
    string username = HttpContextAccessor.HttpContext.Session.GetString("username");
}

<div class="Topbar">
    <div class="currentRule">
        <div class="icon">
            <svg xmlns="http://www.w3.org/2000/svg" width="34"
                 height="34" viewBox="0 0 24 24" fill="none">
                <path d="M13.5 4.29076C13.0368 4.10325 12.5305 4 12 4C9.79086 4 8 5.79086 8 8C8 10.2091 9.79086 12 12 12C13.1947 12 14.2671 11.4762 15 10.6458M18.2015 1.21321C18.1111 1.34235 18.1111 1.52453 18.1111 1.88889V2.48507C18.0219 2.5166 17.9349 2.55273 17.8504 2.59319L17.4287 2.17155C17.1711 1.91391 17.0423 1.78509 16.887 1.75772C16.8296 1.74759 16.7708 1.74759 16.7134 1.75772C16.5581 1.78509 16.4293 1.91391 16.1716 2.17155C15.914 2.4292 15.7852 2.55802 15.7578 2.71327C15.7477 2.77071 15.7477 2.82948 15.7578 2.88692C15.7852 3.04217 15.914 3.17099 16.1716 3.42863L16.5932 3.85024C16.5528 3.93483 16.5166 4.02188 16.4851 4.11111H15.8889C15.5245 4.11111 15.3424 4.11111 15.2132 4.20154C15.1654 4.23499 15.1239 4.27655 15.0904 4.32432C15 4.45346 15 4.63564 15 5C15 5.36436 15 5.54654 15.0904 5.67568C15.1239 5.72345 15.1654 5.76501 15.2132 5.79846C15.3423 5.88889 15.5245 5.88889 15.8889 5.88889H16.4851C16.5166 5.9781 16.5527 6.06512 16.5932 6.14968L16.1716 6.57134C15.9139 6.82898 15.7851 6.9578 15.7577 7.11305C15.7476 7.17049 15.7476 7.22926 15.7577 7.2867C15.7851 7.44196 15.9139 7.57078 16.1716 7.82842C16.4292 8.08606 16.558 8.21488 16.7133 8.24225C16.7707 8.25238 16.8295 8.25238 16.8869 8.24225C17.0422 8.21488 17.171 8.08606 17.4286 7.82842L17.8503 7.40677C17.9349 7.44725 18.0219 7.48339 18.1111 7.51493V8.11111C18.1111 8.47547 18.1111 8.65765 18.2015 8.78679C18.235 8.83457 18.2765 8.87612 18.3243 8.90958C18.4535 9 18.6356 9 19 9C19.3644 9 19.5465 9 19.6757 8.90958C19.7235 8.87612 19.765 8.83457 19.7985 8.78679C19.8889 8.65765 19.8889 8.47547 19.8889 8.11111V7.51493C19.9781 7.48339 20.0652 7.44724 20.1498 7.40675L20.5714 7.82841C20.8291 8.08605 20.9579 8.21487 21.1131 8.24225C21.1706 8.25237 21.2293 8.25237 21.2868 8.24225C21.442 8.21487 21.5709 8.08605 21.8285 7.82841C22.0861 7.57077 22.215 7.44195 22.2423 7.28669C22.2525 7.22925 22.2525 7.17049 22.2423 7.11305C22.215 6.95779 22.0861 6.82897 21.8285 6.57133L21.4068 6.14965C21.4473 6.0651 21.4834 5.97808 21.5149 5.88889H22.1111C22.4755 5.88889 22.6576 5.88889 22.7868 5.79846C22.8346 5.76501 22.8761 5.72345 22.9096 5.67568C23 5.54654 23 5.36436 23 5C23 4.63564 23 4.45346 22.9096 4.32432C22.8761 4.27655 22.8346 4.23499 22.7868 4.20154C22.6576 4.11111 22.4755 4.11111 22.1111 4.11111H21.5149C21.4834 4.02189 21.4472 3.93485 21.4068 3.85028L21.8284 3.42864C22.0861 3.171 22.2149 3.04218 22.2422 2.88693C22.2524 2.82949 22.2524 2.77072 22.2422 2.71328C22.2149 2.55802 22.086 2.4292 21.8284 2.17156C21.5708 1.91392 21.4419 1.7851 21.2867 1.75773C21.2293 1.7476 21.1705 1.7476 21.113 1.75773C20.9578 1.7851 20.829 1.91392 20.5713 2.17156L20.1497 2.59321C20.0651 2.55274 19.9781 2.5166 19.8889 2.48507V1.88889C19.8889 1.52453 19.8889 1.34235 19.7985 1.21321C19.765 1.16543 19.7235 1.12388 19.6757 1.09042C19.5465 1 19.3644 1 19 1C18.6356 1 18.4535 1 18.3243 1.09042C18.2765 1.12388 18.235 1.16543 18.2015 1.21321ZM20 5C20 5.55228 19.5523 6 19 6C18.4477 6 18 5.55228 18 5C18 4.44772 18.4477 4 19 4C19.5523 4 20 4.44772 20 5ZM9.31765 14H14.6824C15.1649 14 15.4061 14 15.6219 14.0461C16.3688 14.2056 17.0147 14.7661 17.3765 15.569C17.4811 15.8009 17.5574 16.0765 17.71 16.6278C17.8933 17.2901 17.985 17.6213 17.9974 17.8884C18.0411 18.8308 17.5318 19.6817 16.7756 19.9297C16.5613 20 16.2714 20 15.6916 20H8.30844C7.72864 20 7.43875 20 7.22441 19.9297C6.46818 19.6817 5.95888 18.8308 6.00261 17.8884C6.01501 17.6213 6.10668 17.2901 6.29003 16.6278C6.44262 16.0765 6.51891 15.8009 6.62346 15.569C6.9853 14.7661 7.63116 14.2056 8.37806 14.0461C8.59387 14 8.83513 14 9.31765 14Z"
                      stroke="#464455" stroke-linecap="round"
                      stroke-linejoin="round" />
            </svg>
        </div>
        @if ((await AuthorizationService.AuthorizeAsync(User, "Admin")).Succeeded)
        {
            <div class="Text">Administrateur</div>
        }
        else if ((await AuthorizationService.AuthorizeAsync(User, "User")).Succeeded)
        {
            <div class="Text">Utilisateur</div>
        }
        else
        {
            <div class="Text">Moderateur</div>
        }
    </div>
    <div class="LoggedUser">
        <div class="selectMenu" id="usernameElement">
            <div class="icon">
                <img src="/img/user.png" alt="user_photo">
            </div>
            <div class="Text">
                @username
                <svg id="chevr" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg"><g id="SVGRepo_bgCarrier" stroke-width="0"></g><g id="SVGRepo_tracerCarrier" stroke-linecap="round" stroke-linejoin="round"></g><g id="SVGRepo_iconCarrier"> <path d="M6 9L12 15L18 9" stroke="#000000" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"></path> </g></svg>
            </div>
        </div>
        <div class="dropdownMenu">
            <a class="option" asp-controller="Activity" asp-action="UserActivity">
                <svg width="27" height="27" viewBox="0 0 27 27" fill="none" xmlns="http://www.w3.org/2000/svg">
                    <g clip-path="url(#clip0_119_2)">
                        <path d="M21.0938 19.4063H21.0756C20.8954 19.4021 20.7212 19.3405 20.5785 19.2304C20.4358 19.1202 20.3321 18.9673 20.2825 18.794L17.61 9.44157L15.9777 13.7959C15.9174 13.9568 15.8094 14.0954 15.6682 14.1933C15.527 14.2912 15.3593 14.3437 15.1875 14.3438H11.8125V12.6563H14.6024L16.9286 6.45377C16.991 6.28756 17.1043 6.14527 17.2522 6.04713C17.4002 5.94899 17.5753 5.89999 17.7527 5.90711C17.9301 5.91423 18.1007 5.97711 18.2404 6.08679C18.38 6.19648 18.4814 6.34739 18.5304 6.51807L21.1555 15.7083L22.825 10.7018C22.8808 10.5338 22.9882 10.3877 23.1318 10.2841C23.2754 10.1806 23.448 10.1249 23.625 10.125H27V11.8125H24.2331L21.8938 18.8295C21.838 18.9975 21.7306 19.1437 21.587 19.2472C21.4434 19.3507 21.2708 19.4064 21.0938 19.4063Z" fill="#595959" />
                        <path d="M12.6562 25.3125H10.9688V19.4062C10.968 18.7351 10.7011 18.0917 10.2266 17.6172C9.75201 17.1427 9.1086 16.8757 8.4375 16.875H5.0625C4.3914 16.8757 3.74799 17.1427 3.27345 17.6172C2.79891 18.0917 2.53199 18.7351 2.53125 19.4062V25.3125H0.84375V19.4062C0.845067 18.2878 1.28996 17.2155 2.08085 16.4246C2.87173 15.6337 3.94402 15.1888 5.0625 15.1875H8.4375C9.55598 15.1888 10.6283 15.6337 11.4192 16.4246C12.21 17.2155 12.6549 18.2878 12.6562 19.4062V25.3125Z" fill="#595959" />
                        <path d="M6.75 6.75C7.25064 6.75 7.74003 6.89846 8.15629 7.17659C8.57255 7.45473 8.89699 7.85006 9.08857 8.31258C9.28016 8.77511 9.33028 9.28406 9.23261 9.77507C9.13495 10.2661 8.89387 10.7171 8.53987 11.0711C8.18586 11.4251 7.73484 11.6662 7.24382 11.7639C6.75281 11.8615 6.24386 11.8114 5.78133 11.6198C5.31881 11.4282 4.92348 11.1038 4.64534 10.6875C4.36721 10.2713 4.21875 9.78188 4.21875 9.28125C4.21875 8.60992 4.48544 7.96609 4.96014 7.49139C5.43484 7.01668 6.07867 6.75 6.75 6.75ZM6.75 5.0625C5.91561 5.0625 5.09996 5.30993 4.40619 5.77349C3.71242 6.23705 3.17169 6.89593 2.85239 7.6668C2.53308 8.43768 2.44953 9.28593 2.61231 10.1043C2.7751 10.9226 3.17689 11.6744 3.7669 12.2644C4.3569 12.8544 5.10861 13.2562 5.92696 13.4189C6.74532 13.5817 7.59357 13.4982 8.36445 13.1789C9.13532 12.8596 9.7942 12.3188 10.2578 11.6251C10.7213 10.9313 10.9688 10.1156 10.9688 9.28125C10.9688 8.16237 10.5243 7.08931 9.73311 6.29814C8.94194 5.50697 7.86888 5.0625 6.75 5.0625Z" fill="#595959" />
                    </g>
                    <defs>
                        <clipPath id="clip0_119_2">
                            <rect width="27" height="27" fill="white" />
                        </clipPath>
                    </defs>
                </svg>
                <span>Activité</span>
            </a>
            <a class="option">
                <svg xmlns="http://www.w3.org/2000/svg" width="24"
                     height="24" viewBox="0 0 24 24" fill="none">
                    <path d="M19.9994 19.2611H10.9294C10.4794 19.2611 10.1094 18.8911 10.1094 18.4411C10.1094 17.9911 10.4794 17.6211 10.9294 17.6211H19.9994C20.4494 17.6211 20.8194 17.9911 20.8194 18.4411C20.8194 18.9011 20.4494 19.2611 19.9994 19.2611Z"
                          fill="#595959" />
                    <path d="M19.9994 12.9681H10.9294C10.4794 12.9681 10.1094 12.5981 10.1094 12.1481C10.1094 11.6981 10.4794 11.3281 10.9294 11.3281H19.9994C20.4494 11.3281 20.8194 11.6981 20.8194 12.1481C20.8194 12.5981 20.4494 12.9681 19.9994 12.9681Z"
                          fill="#595959" />
                    <path d="M19.9994 6.67125H10.9294C10.4794 6.67125 10.1094 6.30125 10.1094 5.85125C10.1094 5.40125 10.4794 5.03125 10.9294 5.03125H19.9994C20.4494 5.03125 20.8194 5.40125 20.8194 5.85125C20.8194 6.30125 20.4494 6.67125 19.9994 6.67125Z"
                          fill="#595959" />
                    <path d="M4.90969 8.03187C4.68969 8.03187 4.47969 7.94187 4.32969 7.79187L3.41969 6.88188C3.09969 6.56188 3.09969 6.04187 3.41969 5.72187C3.73969 5.40187 4.25969 5.40187 4.57969 5.72187L4.90969 6.05188L7.04969 3.91187C7.36969 3.59188 7.88969 3.59188 8.20969 3.91187C8.52969 4.23188 8.52969 4.75188 8.20969 5.07188L5.48969 7.79187C5.32969 7.94187 5.12969 8.03187 4.90969 8.03187Z"
                          fill="#595959" />
                    <path d="M4.90969 14.3287C4.69969 14.3287 4.48969 14.2487 4.32969 14.0887L3.41969 13.1788C3.09969 12.8588 3.09969 12.3388 3.41969 12.0188C3.73969 11.6988 4.25969 11.6988 4.57969 12.0188L4.90969 12.3488L7.04969 10.2087C7.36969 9.88876 7.88969 9.88876 8.20969 10.2087C8.52969 10.5288 8.52969 11.0487 8.20969 11.3687L5.48969 14.0887C5.32969 14.2487 5.11969 14.3287 4.90969 14.3287Z"
                          fill="#595959" />
                    <path d="M4.90969 20.3288C4.69969 20.3288 4.48969 20.2488 4.32969 20.0888L3.41969 19.1788C3.09969 18.8588 3.09969 18.3388 3.41969 18.0188C3.73969 17.6988 4.25969 17.6988 4.57969 18.0188L4.90969 18.3488L7.04969 16.2087C7.36969 15.8888 7.88969 15.8888 8.20969 16.2087C8.52969 16.5288 8.52969 17.0488 8.20969 17.3688L5.48969 20.0888C5.32969 20.2488 5.11969 20.3288 4.90969 20.3288Z"
                          fill="#595959" />
                </svg>
                <span>Tâches</span>
            </a>
        </div>
    </div>
</div>
<script>
    // Script d'affichage pour menu deroulant du topbar
    document.addEventListener('DOMContentLoaded', function () {
        const usernameElement = document.getElementById('usernameElement');
        const dropdownMenu = document.querySelector('.dropdownMenu');
        const chevron = document.getElementById('chevr');

        // Function to toggle the dropdown menu
        function toggleDropdown() {
            dropdownMenu.style.display = (dropdownMenu.style.display === 'block') ? 'none' : 'block';
            // Add your rotation animation logic for the chevron here
            chevron.style.transform = (dropdownMenu.style.display === 'block') ? 'rotate(180deg)' : 'rotate(0deg)';
            chevron.style.transition = 'transform 0.3s ease'
        }

        // Event listener for clicks on the username element
        usernameElement.addEventListener('click', function (event) {
            event.stopPropagation(); // Prevents the click event from reaching the document click handler
            toggleDropdown();
        });

        // Event listener for clicks outside the dropdown menu
        document.addEventListener('click', function () {
            dropdownMenu.style.display = 'none';
            // Reset chevron rotation when the menu is hidden
            chevron.style.transform = 'rotate(0deg)';
        });
    });
</script>